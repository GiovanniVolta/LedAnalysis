##############################
#### XENON1T configuration ###
##############################

# ROOT key alias
MC_branch_alias = [['rrp_pri','(xp_pri*xp_pri + yp_pri*yp_pri)/10.']]

# variable ranges [cm]
LXe_minZ  = -96.7
LXe_maxZ  = 0.
LXe_minR  = -47.9
LXe_maxR  = 47.9
LXe_minRR = 0.
LXe_maxRR = 2294.41
LXe_Cut = "zp_pri/10.<={0} && zp_pri/10.>={1} && rrp_pri/10.>={2} && rrp_pri/10.<={3}".format(LXe_maxZ,LXe_minZ,LXe_minRR,LXe_maxRR)

GXe_minZ  = 0.
GXe_maxZ  = 0.6
GXe_minR  = -47.9
GXe_maxR  = 47.9
GXe_minRR = 0.
GXe_maxRR = 2294.41
GXe_Cut = "zp_pri/10.<={0} && zp_pri/10.>={1} && rrp_pri/10.>={2} && rrp_pri/10.<={3}".format(GXe_maxZ,GXe_minZ,GXe_minRR,GXe_maxRR)

TPC_minZ  = -140.
TPC_maxZ  = 6.
TPC_minR  = -60.
TPC_maxR  = 60.
TPC_minRR = 0.
TPC_maxRR = 3600.
TPC_Cut = "zp_pri/10.<={0} && zp_pri/10.>={1} && rrp_pri/10.>={2} && rrp_pri/10.<={3}".format(TPC_maxZ,TPC_minZ,TPC_minRR,TPC_maxRR)

QE_top = 0.314
QE_bottom = 0.366
PMTs_top = 127
PMTs_bottom = 121

nbinsZ  = 100
nbinsRR = 100
nbinsR  = 100
LCE_min = 0
LCE_max = 100

# PMT values as in PAX
# (Hamamatsu datasheets)
PMT_QEs = [0.281,0.283,0.284,0.284,0.286,0.287,0.290,0.293,0.293,0.294,0.295,0.296,0.296,0.297,0.329,0.298,0.299,0.301,0.302,0.304,0.305,0.308,0.308,0.308,0.309,0.309,0.310,0.310,0.310,0.311,0.312,0.314,0.330,0.315,0.315,0.315,0.315,0.316,0.316,0.317,0.319,0.327,0.320,0.320,0.321,0.342,0.322,0.322,0.322,0.322,0.322,0.321,0.323,0.323,0.323,0.323,0.324,0.325,0.325,0.325,0.325,0.325,0.325,0.325,0.325,0.326,0.326,0.326,0.326,0.326,0.319,0.327,0.328,0.328,0.328,0.328,0.328,0.297,0.329,0.329,0.329,0.329,0.329,0.329,0.330,0.330,0.331,0.331,0.331,0.332,0.332,0.332,0.332,0.333,0.334,0.334,0.335,0.336,0.336,0.337,0.338,0.339,0.339,0.340,0.340,0.340,0.350,0.341,0.341,0.341,0.341,0.341,0.341,0.341,0.342,0.342,0.342,0.321,0.342,0.342,0.342,0.342,0.343,0.343,0.345,0.345,0.345,0.404,0.405,0.413,0.352,0.350,0.316,0.360,0.346,
           0.346,0.347,0.347,0.348,0.347,0.329,0.359,0.374,0.360,0.361,0.361,0.361,0.349,0.394,0.347,0.358,0.380,0.385,0.374,0.376,0.376,0.363,0.349,0.389,0.342,0.357,0.372,0.385,0.396,0.386,0.387,0.376,0.363,0.351,0.389,0.359,0.357,0.371,0.385,0.395,0.400,0.397,0.390,0.376,0.363,0.351,0.359,0.356,0.371,0.385,0.393,0.399,0.401,0.397,0.390,0.378,0.363,0.352,0.343,0.356,0.371,0.385,0.393,0.399,0.397,0.391,0.380,0.363,0.353,0.334,0.315,0.336,0.370,0.384,0.393,0.391,0.391,0.373,0.364,0.353,0.400,0.339,0.356,0.369,0.383,0.382,0.381,0.381,0.364,0.353,0.387,0.357,0.356,0.368,0.367,0.367,0.367,0.366,0.354,0.322,0.334,0.356,0.355,0.354,0.354,0.354,0.354,0.324,0.320,0.383,0.374,0.326,0.324]
PMT_positions = [{'x': -12.345668451390225, 'y': 46.074661913988564},{'x': -4.1573289290632864, 'y': 47.518487098976266},{'x': 4.1573289290632935, 'y': 47.518487098976259},{'x': 12.345668451390232, 'y': 46.074661913988557},{'x': 20.158891085031385, 'y': 43.230881441648194},{'x': 27.359596013944909, 'y': 39.073552512584904},{'x': 33.728993462598353, 'y': 33.728993462598289},{'x': 39.073552512584904, 'y': 27.359596013944902},{'x': 43.230881441648222, 'y': 20.158891085031343},{'x': 46.074661913988564, 'y': 12.345668451390226},{'x': 47.518487098976266, 'y': 4.1573289290632882},{'x': 47.518487098976259, 'y': -4.1573289290632918},{'x': 46.07466191398855, 'y': -12.345668451390271},{'x': 43.230881441648194, 'y': -20.158891085031378},{'x': 39.073552512584889, 'y': -27.359596013944923},{'x': 33.728993462598318, 'y': -33.728993462598318},{'x': 27.359596013944891, 'y': -39.073552512584911},{'x': 20.158891085031346, 'y': -43.230881441648222},{'x': 12.34566845139023, 'y': -46.074661913988564},{'x': 4.1573289290632918, 'y': -47.518487098976266},{'x': -4.1573289290633095, 'y': -47.518487098976259},{'x': -12.345668451390264, 'y': -46.074661913988557},{'x': -20.158891085031378, 'y': -43.230881441648194},{'x': -27.359596013944902, 'y': -39.073552512584911},
                 {'x': -33.728993462598325, 'y': -33.728993462598304},{'x': -39.073552512584918, 'y': -27.359596013944888},{'x': -43.230881441648208, 'y': -20.158891085031357},{'x': -46.074661913988564, 'y': -12.345668451390232},{'x': -47.518487098976266, 'y': -4.1573289290632864},{'x': -47.518487098976259, 'y': 4.157328929063306},{'x': -46.074661913988557, 'y': 12.345668451390251},{'x': -43.230881441648201, 'y': 20.158891085031371},{'x': -39.073552512584904, 'y': 27.359596013944902},{'x': -33.728993462598311, 'y': 33.728993462598318},{'x': -27.359596013944895, 'y': 39.073552512584911},{'x': -20.158891085031357, 'y': 43.230881441648208},{'x': -10.288057042825152, 'y': 38.395551594990479},{'x': -2.0803542606570264, 'y': 39.695524006494317},{'x': 6.2182699853491794, 'y': 39.260611538656725},{'x': 14.245125994425699, 'y': 37.109821953263769},{'x': 21.649401641847319, 'y': 33.337155075830609},{'x': 28.107494552165267, 'y': 28.107494552165264},{'x': 33.337155075830609, 'y': 21.649401641847316},{'x': 37.109821953263783, 'y': 14.245125994425663},{'x': 39.260611538656732, 'y': 6.2182699853491421},{'x': 39.695524006494303, 'y': -2.0803542606570282},{'x': 38.395551594990451, 'y': -10.288057042825226},{'x': 35.417509336487612, 'y': -18.046122364647005},
                 {'x': 30.891551967914587, 'y': -25.015485544231051},{'x': 25.015485544231034, 'y': -30.891551967914602},{'x': 18.046122364646969, 'y': -35.417509336487633},{'x': 10.288057042825173, 'y': -38.395551594990472},{'x': 2.080354260657014, 'y': -39.695524006494317},{'x': -6.2182699853491759, 'y': -39.260611538656725},
                 {'x': -14.245125994425695, 'y': -37.109821953263769},{'x': -21.649401641847341, 'y': -33.337155075830594},{'x': -28.107494552165271, 'y': -28.107494552165253},{'x': -33.337155075830609, 'y': -21.649401641847319},{'x': -37.109821953263776, 'y': -14.245125994425678},{'x': -39.260611538656725, 'y': -6.2182699853491723},{'x': -39.695524006494303, 'y': 2.0803542606570229},{'x': -38.395551594990465, 'y': 10.288057042825208},{'x': -35.417509336487619, 'y': 18.04612236464699},{'x': -30.891551967914587, 'y': 25.015485544231041},{'x': -25.015485544231034, 'y': 30.891551967914602},{'x': -18.04612236464698, 'y': 35.417509336487633},{'x': -8.2304456342601497, 'y': 30.716441275992377},{'x': 3.1086244689504383e-14, 'y': 31.800000000000001},{'x': 8.2304456342601817, 'y': 30.716441275992366},{'x': 15.900000000000009, 'y': 27.539607840345141},{'x': 22.485995641732213, 'y': 22.485995641732213},{'x': 27.539607840345159, 'y': 15.899999999999984},{'x': 30.716441275992374, 'y': 8.2304456342601515},{'x': 31.800000000000001, 'y': 0.0},{'x': 30.716441275992366, 'y': -8.2304456342601817},{'x': 27.539607840345138, 'y': -15.90000000000002},{'x': 22.485995641732202, 'y': -22.485995641732224},{'x': 15.899999999999999, 'y': -27.539607840345152},
                 {'x': 8.2304456342601533, 'y': -30.716441275992374},{'x': -1.3322676295501878e-14, 'y': -31.800000000000001},{'x': -8.2304456342601622, 'y': -30.716441275992374},{'x': -15.900000000000006, 'y': -27.539607840345145},{'x': -22.485995641732217, 'y': -22.485995641732202},{'x': -27.539607840345152, 'y': -15.899999999999993},{'x': -30.716441275992374, 'y': -8.2304456342601551},{'x': -31.800000000000001, 'y': 3.5527136788005009e-15},{'x': -30.71644127599237, 'y': 8.2304456342601675},{'x': -27.539607840345145, 'y': 15.900000000000006},{'x': -22.48599564173221, 'y': 22.485995641732217},{'x': -15.899999999999997, 'y': 27.539607840345152},{'x': -6.1728342256951123, 'y': 23.037330956994282},{'x': 2.0786644645316468, 'y': 23.759243549488129},{'x': 10.079445542515693, 'y': 21.615440720824097},{'x': 16.864496731299177, 'y': 16.864496731299145},{'x': 21.615440720824111, 'y': 10.079445542515671},{'x': 23.759243549488133, 'y': 2.0786644645316441},{'x': 23.037330956994275, 'y': -6.1728342256951354},{'x': 19.536776256292445, 'y': -13.679798006972462},{'x': 13.679798006972446, 'y': -19.536776256292455},{'x': 6.172834225695115, 'y': -23.037330956994282},{'x': -2.0786644645316548, 'y': -23.759243549488129},
                 {'x': -10.079445542515689, 'y': -21.615440720824097},{'x': -16.864496731299162, 'y': -16.864496731299152},{'x': -21.615440720824104, 'y': -10.079445542515678},{'x': -23.759243549488133, 'y': -2.0786644645316432},{'x': -23.037330956994278, 'y': 6.1728342256951256},{'x': -19.536776256292452, 'y': 13.679798006972451},{'x': -13.679798006972447, 'y': 19.536776256292455},
                 {'x': -4.1152228171300749, 'y': 15.358220637996189},{'x': 4.1152228171300909, 'y': 15.358220637996183},{'x': 11.242997820866107, 'y': 11.242997820866107},{'x': 15.358220637996187, 'y': 4.1152228171300758},{'x': 15.358220637996183, 'y': -4.1152228171300909},{'x': 11.242997820866101, 'y': -11.242997820866112},{'x': 4.1152228171300766, 'y': -15.358220637996187},{'x': -4.1152228171300811, 'y': -15.358220637996187},{'x': -11.242997820866108, 'y': -11.242997820866101},{'x': -15.358220637996187, 'y': -4.1152228171300775},{'x': -15.358220637996185, 'y': 4.1152228171300838},{'x': -11.242997820866105, 'y': 11.242997820866108},{'x': -2.0576114085650374, 'y': 7.6791103189980943},{'x': 5.6214989104330533, 'y': 5.6214989104330533},{'x': 7.6791103189980916, 'y': -2.0576114085650454},{'x': 2.0576114085650383, 'y': -7.6791103189980934},{'x': -5.6214989104330542, 'y': -5.6214989104330506},{'x': -7.6791103189980925, 'y': 2.0576114085650419},{'x': 0.0, 'y': 0.0},{'x': -30.689924073888996, 'y': 32.282016051339312},{'x': -23.2988878137987, 'y': 35.343483510260029},{'x': -15.907851553708406, 'y': 38.404950969180746},{'x': -8.5168152936181123, 'y': 41.466418428101463},{'x': -1.1257790335278184, 'y': 44.52788588702218},{'x': -39.125169871739701, 'y': 21.2889897014281},
                 {'x': -31.734133611649405, 'y': 24.350457160348821},{'x': -24.343097351559109, 'y': 27.411924619269541},{'x': -16.952061091468817, 'y': 30.473392078190258},{'x': -9.5610248313785249, 'y': 33.534859537110975},{'x': -2.169988571288231, 'y': 36.596326996031692},{'x': 5.2210476888020647, 'y': 39.657794454952409},{'x': 12.612083948892357, 'y': 42.719261913873133},{'x': -40.16937940950011, 'y': 13.357430810437622},{'x': -32.778343149409821, 'y': 16.418898269358341},{'x': -25.387306889319525, 'y': 19.480365728279057},{'x': -17.99627062922923, 'y': 22.541833187199778},{'x': -10.605234369138937, 'y': 25.603300646120495},{'x': -3.2141981090486436, 'y': 28.664768105041212},{'x': 4.1768381510416503, 'y': 31.726235563961932},{'x': 11.567874411131942, 'y': 34.787703022882653},{'x': 18.958910671222238, 'y': 37.84917048180337},{'x': -41.213588947260526, 'y': 5.4258719194471414},{'x': -33.82255268717023, 'y': 8.4873393783678583},{'x': -26.431516427079938, 'y': 11.548806837288577},{'x': -19.040480166989642, 'y': 14.610274296209296},{'x': -11.64944390689935, 'y': 17.671741755130014},{'x': -4.2584076468090561, 'y': 20.733209214050731},{'x': 3.1326286132812369, 'y': 23.794676672971448},{'x': 10.523664873371533, 'y': 26.856144131892169},
                 {'x': 17.914701133461826, 'y': 29.917611590812889},{'x': 25.305737393552118, 'y': 32.979079049733606},{'x': -42.257798485020942, 'y': -2.5056869715433443},{'x': -34.866762224930646, 'y': 0.5557804873773744},{'x': -27.47572596484035, 'y': 3.6172479462980931},{'x': -20.084689704750055, 'y': 6.6787154052188109},
                 {'x': -12.693653444659763, 'y': 9.7401828641395287},{'x': -5.3026171845694687, 'y': 12.801650323060247},{'x': 2.0884190755208252, 'y': 15.863117781980966},{'x': 9.4794553356111191, 'y': 18.924585240901685},{'x': 16.870491595701409, 'y': 21.986052699822402},{'x': 24.261527855791705, 'y': 25.047520158743119},{'x': 31.652564115882001, 'y': 28.108987617663839},{'x': -43.302008022781351, 'y': -10.437245862533826},{'x': -35.910971762691055, 'y': -7.3757784036131078},{'x': -28.519935502600763, 'y': -4.3143109446923908},{'x': -21.128899242510471, 'y': -1.2528434857716721},{'x': -13.737862982420175, 'y': 1.8086239731490465},{'x': -6.3468267223298813, 'y': 4.8700914320697644},{'x': 1.0442095377604126, 'y': 7.9315588909904831},{'x': 8.4352457978507047, 'y': 10.993026349911201},{'x': 15.826282057941, 'y': 14.05449380883192},{'x': 23.217318318031293, 'y': 17.115961267752638},{'x': 30.608354578121585, 'y': 20.177428726673355},{'x': 37.99939083821188, 'y': 23.238896185594072},{'x': -36.955181300451471, 'y': -15.307337294603592},{'x': -29.564145040361176, 'y': -12.245869835682873},{'x': -22.17310878027088, 'y': -9.1844023767621543},{'x': -14.782072520180588, 'y': -6.1229349178414365},{'x': -7.3910362600902939, 'y': -3.0614674589207183},{'x': 0.0, 'y': 0.0},
                 {'x': 7.3910362600902939, 'y': 3.0614674589207183},{'x': 14.782072520180588, 'y': 6.1229349178414365},{'x': 22.17310878027088, 'y': 9.1844023767621543},{'x': 29.564145040361176, 'y': 12.245869835682873},{'x': 36.955181300451471, 'y': 15.307337294603592},{'x': -37.99939083821188, 'y': -23.238896185594072}, 
                 {'x': -30.608354578121585, 'y': -20.177428726673355},{'x': -23.217318318031293, 'y': -17.115961267752638},{'x': -15.826282057941, 'y': -14.05449380883192},{'x': -8.4352457978507047, 'y': -10.993026349911201},{'x': -1.0442095377604126, 'y': -7.9315588909904831},{'x': 6.3468267223298813, 'y': -4.8700914320697644},{'x': 13.737862982420175, 'y': -1.8086239731490465},{'x': 21.128899242510471, 'y': 1.2528434857716721},{'x': 28.519935502600763, 'y': 4.3143109446923908},{'x': 35.910971762691055, 'y': 7.3757784036131078},{'x': 43.302008022781351, 'y': 10.437245862533826},{'x': -31.652564115882001, 'y': -28.108987617663839},{'x': -24.261527855791705, 'y': -25.047520158743119},{'x': -16.870491595701409, 'y': -21.986052699822402},{'x': -9.4794553356111191, 'y': -18.924585240901685},{'x': -2.0884190755208252, 'y': -15.863117781980966},{'x': 5.3026171845694687, 'y': -12.801650323060247},{'x': 12.693653444659763, 'y': -9.7401828641395287},{'x': 20.084689704750055, 'y': -6.6787154052188109},{'x': 27.47572596484035, 'y': -3.6172479462980931},{'x': 34.866762224930646, 'y': -0.5557804873773744},{'x': 42.257798485020942, 'y': 2.5056869715433443},{'x': -25.305737393552118, 'y': -32.979079049733606},{'x': -17.914701133461826, 'y': -29.917611590812889},
                 {'x': -10.523664873371533, 'y': -26.856144131892169},{'x': -3.1326286132812369, 'y': -23.794676672971448},{'x': 4.2584076468090561, 'y': -20.733209214050731},{'x': 11.64944390689935, 'y': -17.671741755130014},{'x': 19.040480166989642, 'y': -14.610274296209296},{'x': 26.431516427079938, 'y': -11.548806837288577},{'x': 33.82255268717023, 'y': -8.4873393783678583},{'x': 41.213588947260526, 'y': -5.4258719194471414},{'x': -18.958910671222238, 'y': -37.84917048180337},{'x': -11.567874411131942, 'y': -34.787703022882653},{'x': -4.1768381510416503, 'y': -31.726235563961932},{'x': 3.2141981090486436, 'y': -28.664768105041212},{'x': 10.605234369138937, 'y': -25.603300646120495},{'x': 17.99627062922923, 'y': -22.541833187199778},{'x': 25.387306889319525, 'y': -19.480365728279057},{'x': 32.778343149409821, 'y': -16.418898269358341},{'x': 40.16937940950011, 'y': -13.357430810437622},{'x': -12.612083948892357, 'y': -42.719261913873133},{'x': -5.2210476888020647, 'y': -39.657794454952409},{'x': 2.169988571288231, 'y': -36.596326996031692},{'x': 9.5610248313785249, 'y': -33.534859537110975},{'x': 16.952061091468817, 'y': -30.473392078190258},{'x': 24.343097351559109, 'y': -27.411924619269541},{'x': 31.734133611649405, 'y': -24.350457160348821},
                 {'x': 39.125169871739701, 'y': -21.2889897014281},{'x': 1.1257790335278184, 'y': -44.52788588702218},{'x': 8.5168152936181123, 'y': -41.466418428101463},{'x': 15.907851553708406, 'y': -38.404950969180746},{'x': 23.2988878137987, 'y': -35.343483510260029},{'x': 30.689924073888996, 'y': -32.282016051339312}]
top_channels = list(range(0, 127))
bottom_channels = list(range(127, 247+1))
PMT_distance_top = 7.95  # cm
PMT_distance_bottom = 8.0  # cm
PMTOuterRingRadius = 3.875  # cm

# Values for the ScienceRuns
Excluded_PMTs_SR1 = [1, 12, 26, 34, 62, 65, 79, 86, 88, 102, 118, 130, 134, 135, 148, 150, 152, 162, 178, 183, 198, 206, 213, 214, 234, 239, 244, 51, 73, 137, 139, 27, 91, 167, 203] #https://xecluster.lngs.infn.it/dokuwiki/doku.php?id=xenon:xenon1t:analysis:firstresults:data_quality_pmt#list_of_pmts_excluded_from_the_first_science_result_shingo_oliver

# https://indico.in2p3.fr/event/9408/session/8/contribution/30/material/slides/0.pdf
# https://arxiv.org/pdf/1202.2628.pdf
# https://arxiv.org/pdf/1509.04055.pdf
# https://arxiv.org/pdf/1502.01000.pdf QE increase
PMT_CE = 0.90 # as reported by the PMT group
PMT_QE_Inc = 1.10 # increase at cryogenic temperatures

############################################################################################################